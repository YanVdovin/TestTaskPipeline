# Библиотека потоковой обработки данных на Go

## Описание

Библиотека предназначена для создания конвейеров обработки данных в виде направленных графов, где узлы выполняют элементарные операции обработки. Она поддерживает параллельное выполнение операций и корректную остановку с использованием `context.Context`.

## Возможности

- Узлы имеют от 0 до N входов и от 0 до M выходов, реализованных как каналы `chan interface{}`.
- Соединение узлов через метод `Connect` или вручную с помощью `SetInput` / `SetOutput`.
- Параллельное выполнение узлов с использованием горутин.
- Управление выполнением через `context.Context` для обработки отмены.

## Демонстрационная задача

Демонстрационная задача вычисляет MD5-хеши файлов в указанной директории с настраиваемой степенью параллелизма.

## Запуск демонстрации

1. Поместите файлы `lib.go` и `main.go` в одну директорию.
2. Выполните команду с опциональными флагами:

```bash
go run main.go -dir=<путь_к_директории> -workers=<количество_воркеров>
```

## Аргументы:

    -dir: Директория для сканирования (по умолчанию: текущая директория .).

    -workers: Количество воркеров для параллельного вычисления хешей (по умолчанию: 10).

## Пример:

go run main.go -dir=/путь/к/файлам -workers=5

Команда обходит директорию /путь/к/файлам, вычисляет MD5-хеши файлов с использованием 5 воркеров и выводит результаты в консоль.



# Структура проекта

## `lib/lib.go` — Библиотека ядра

Содержит общую инфраструктуру для построения потоковых конвейеров.

### Интерфейсы и структуры

#### `Node` — интерфейс для всех узлов обработки:

- `Process(ctx context.Context)`
- `SetInput(index int, ch <-chan interface{}) error`
- `SetOutput(index int, ch chan<- interface{}) error`

#### `BaseNode` — реализация базовой логики для управления входами/выходами узлов

- Управляет срезами:
  - `Inputs []<-chan interface{}`
  - `Outputs []chan<- interface{}`
- Методы автоматически расширяют срезы при необходимости.

#### `Pipeline` — структура для управления конвейером:

- `AddNode(Node)` — добавляет узел в конвейер.
- `Connect(from, fromOutput, to, toInput)` — соединяет узлы через каналы.
- `Start(ctx)` — запускает все узлы параллельно и ожидает их завершения.

---

## `main.go` — Демонстрация

Реализует практическое использование библиотеки: сканирование файловой системы, хеширование и вывод результатов.

### Узлы

#### `SourceNode` — источник данных:

- Обходит указанную директорию и отправляет пути ко всем файлам в выходной канал.

#### `WorkerNode` — обработчик:

- Получает пути файлов.
- Вычисляет их MD5-хеш.
- Отправляет строку с результатом в выходной канал.

#### `SinkNode` — приёмник:

- Читает результаты с нескольких входов.
- Печатает их в консоль.

### Главная функция (`main`)

- Читает параметры командной строки:
  - `-dir` — директория для сканирования.
  - `-workers` — количество воркеров (по умолчанию 10).
- Создаёт узлы: `Source`, `Worker`, `Sink`.
- Связывает узлы через буферизированные каналы.
- Запускает выполнение через `Pipeline.Start()`.
